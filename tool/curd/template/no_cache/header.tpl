{{- define "header" -}}
// Code generated by muxi curd. DO NOT EDIT.

package {{.PackageName}}

import (
    "context"
    "fmt"
    "github.com/muxi-Infra/muxi-micro/pkg/sql"
    "golang.org/x/sync/singleflight"
    "gorm.io/gorm"
)

var group singleflight.Group

type {{.ModelName}}Model interface {
    Create(ctx context.Context, data *{{.ModelName}}) error
    FindOne(ctx context.Context, id int64) (*{{.ModelName}}, error)
    {{- range $notPr := .NotPrs}}
    FindBy{{$notPr}}(ctx context.Context, {{$notPr}} string) (*[]{{$.ModelName}}, error)
    {{- end}}
    Update(ctx context.Context, data *{{.ModelName}}) error
    Delete(ctx context.Context, id int64) error
}

type {{.ModelName}}Exec struct {
    exec      *sql.Execute
}

func New{{.ModelName}}Model(db *gorm.DB) *{{.ModelName}}Exec {
    exec := sql.NewExecute({{.ModelName}}{}, db)
    return &{{.ModelName}}Exec{
        exec:      exec,
    }
}

{{template "db2" $}}

{{- end -}}